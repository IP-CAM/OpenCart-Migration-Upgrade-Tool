<modification>
	<name>Bugs 2.0.2.0 Fix</name>
	<version>1.3</version>
	<author>peku</author>
	<code>aADw9893</code>
	<file path="admin/controller/sale/order.php">
		<operation>
			<search><![CDATA[public function api() {]]></search>
			<add position="after"><![CDATA[                                              $json = array();]]></add>
		</operation>
	</file>
	<file path="admin/controller/sale/custom_field.php">
		<operation>
			<search><![CDATA[if ($custom_field_customer_group['required']) {]]></search>
			<add position="replace"><![CDATA[if ( isset($custom_field_customer_group['required']) ) {]]></add>
		</operation>
	</file>
	<file path="admin/controller/module/html.php">
		<operation>
			<search><![CDATA[$data['module_description'] = '';]]></search>
			<add position="replace"><![CDATA[$data['module_description'] = array();]]></add>
		</operation>
	</file>
	<file path="admin/view/template/module/google_hangouts.tpl">
		<operation>
			<search><![CDATA[<?php echo $code; ?>]]></search>
			<add position="replace"><![CDATA[<?php echo $google_hangouts_code; ?>]]></add>
		</operation>
	</file>
	<file path="catalog/controller/information/contact.php">
		<operation>
			<search><![CDATA[$this->config->get('config_mail_smtp_host')]]></search>
			<add position="replace"><![CDATA[$this->config->get('config_mail_smtp_hostname')]]></add>
		</operation>
	</file>
	<file path="catalog/model/account/customer.php">
		<operation>
			<search><![CDATA[$this->config->get('config_mail_smtp_host')]]></search>
			<add position="replace"><![CDATA[$this->config->get('config_mail_smtp_hostname')]]></add>
		</operation>
		<operation>
			<search><![CDATA[$mail->setSubject($this->language->get('text_new_customer'));]]></search>
			<add position="before"><![CDATA[			$mail->setFrom($this->config->get('config_email'));
			$mail->setTo($this->config->get('config_email'));
                        $mail->setSender($this->config->get('config_name'));]]></add>
		</operation>
	</file>
	<file path="catalog/model/checkout/order.php">
		<operation>
			<search><![CDATA[$this->config->get('config_mail_smtp_host')]]></search>
			<add position="replace"><![CDATA[$this->config->get('config_mail_smtp_hostname')]]></add>
		</operation>
		<operation>
			<search><![CDATA[$language->load('default');]]></search>
			<add position="replace"><![CDATA[$language->load($order_info['language_directory']);]]></add>
		</operation>
	</file>
	<file path="catalog/model/checkout/voucher.php">
		<operation>
			<search><![CDATA[$language->load('default');]]></search>
			<add position="replace"><![CDATA[$language->load($order_info['language_directory']);]]></add>
		</operation>
	</file>
	<file path="catalog/model/openbay/ebay_order.php">
		<operation>
			<search><![CDATA[$language->load('default');]]></search>
			<add position="replace"><![CDATA[$language->load($order_info['language_directory']);]]></add>
		</operation>
	</file>
	<file path="system/library/openbay.php">
		<operation>
			<search><![CDATA[$language->load('default');]]></search>
			<add position="replace"><![CDATA[$language->load($order_info['language_directory']);]]></add>
		</operation>
	</file>
	<file path="admin/model/sale/voucher.php">
		<operation>
			<search><![CDATA[$language->load('default');]]></search>
			<add position="replace"><![CDATA[$language->load($order_info['language_directory']);]]></add>
		</operation>
	</file>
	<file path="catalog/model/affiliate/affiliate.php">
		<operation>
			<search><![CDATA[$this->config->get('config_mail_smtp_host')]]></search>
			<add position="replace"><![CDATA[$this->config->get('config_mail_smtp_hostname')]]></add>
		</operation>
	</file>
	<file path="admin/model/marketing/affiliate.php">
		<operation>
			<search><![CDATA[$this->config->get('config_mail_smtp_host')]]></search>
			<add position="replace"><![CDATA[$this->config->get('config_mail_smtp_hostname')]]></add>
		</operation>
	</file>
	<file path="admin/model/sale/customer.php">
		<operation>
			<search><![CDATA[$this->config->get('config_mail_smtp_host')]]></search>
			<add position="replace"><![CDATA[$this->config->get('config_mail_smtp_hostname')]]></add>
		</operation>
	</file>
	<file path="catalog/model/total/handling.php">
		<operation>
			<search><![CDATA[if (($this->cart->getSubTotal() <]]></search>
			<add position="replace"><![CDATA[if (($this->cart->getSubTotal() >]]></add>
		</operation>
	</file>
	<file path="catalog/controller/account/register.php">
		<operation>
			<search><![CDATA[$data['breadcrumbs'] = array();]]></search>
			<add position="before"><![CDATA[
		if ($this->config->get('config_google_captcha_status')) {
			$this->document->addScript('https://www.google.com/recaptcha/api.js');

			$data['site_key'] = $this->config->get('config_google_captcha_public');
		} else {
			$data['site_key'] = '';
		}]]></add>
		</operation>
		<operation>
			<search><![CDATA[// Agree to terms]]></search>
			<add position="before"><![CDATA[
		if ($this->config->get('config_google_captcha_status')) {
			$recaptcha = file_get_contents('https://www.google.com/recaptcha/api/siteverify?secret=' . urlencode($this->config->get('config_google_captcha_secret')) . '&response=' . $this->request->post['g-recaptcha-response'] . '&remoteip=' . $this->request->server['REMOTE_ADDR']);

			$recaptcha = json_decode($recaptcha, true);

			if (!$recaptcha['success']) {
				$this->error['captcha'] = $this->language->get('error_captcha');
			}
		}]]></add>
		</operation>
		<operation>
			<search><![CDATA[$data['action'] = $this->url->link('account/register', '', 'SSL');]]></search>
			<add position="before"><![CDATA[
		if (isset($this->error['captcha'])) {
			$data['error_captcha'] = $this->error['captcha'];
		} else {
			$data['error_captcha'] = '';
		}]]></add>
		</operation>
	</file>
	<file path="catalog/view/theme/*/template/account/register.tpl">
		<operation>
			<search><![CDATA[<div class="buttons">]]></search>
			<add position="after"><![CDATA[
          <?php if ($site_key) { ?>
            <div class="form-group">
              <div class="col-sm-offset-2 col-sm-10">
                <div class="g-recaptcha" data-sitekey="<?php echo $site_key; ?>"></div>
                <?php if ($error_captcha) { ?>
                  <div class="text-danger"><?php echo $error_captcha; ?></div>
                <?php } ?>
              </div>
            </div>
          <?php } ?>]]></add>
		</operation>
	</file>
</modification>
